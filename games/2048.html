<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2048</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: #1a1a1a;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      font-family: Arial, sans-serif;
    }
    #gameContainer {
      text-align: center;
    }
    #score {
      color: #00FFFF;
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    #grid {
      background: #bbada0;
      border-radius: 10px;
      padding: 10px;
      display: inline-block;
    }
    .row {
      display: flex;
    }
    .cell {
      width: 80px;
      height: 80px;
      background: rgba(238, 228, 218, 0.35);
      margin: 5px;
      border-radius: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 32px;
      font-weight: bold;
      color: #776e65;
    }
    .cell[data-value="2"] { background: #eee4da; color: #776e65; }
    .cell[data-value="4"] { background: #ede0c8; color: #776e65; }
    .cell[data-value="8"] { background: #f2b179; color: #f9f6f2; }
    .cell[data-value="16"] { background: #f59563; color: #f9f6f2; }
    .cell[data-value="32"] { background: #f67c5f; color: #f9f6f2; }
    .cell[data-value="64"] { background: #f65e3b; color: #f9f6f2; }
    .cell[data-value="128"] { background: #edcf72; color: #f9f6f2; font-size: 28px; }
    .cell[data-value="256"] { background: #edcc61; color: #f9f6f2; font-size: 28px; }
    .cell[data-value="512"] { background: #edc850; color: #f9f6f2; font-size: 28px; }
    .cell[data-value="1024"] { background: #edc53f; color: #f9f6f2; font-size: 24px; }
    .cell[data-value="2048"] { background: #edc22e; color: #f9f6f2; font-size: 24px; }
    #instructions {
      color: #fff;
      margin-top: 20px;
      font-size: 14px;
    }
    #gameOver {
      color: #FF6B6B;
      font-size: 20px;
      display: none;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <div id="score">Score: 0</div>
    <div id="grid"></div>
    <div id="instructions">Utilisez les flèches ← ↑ → ↓ pour jouer</div>
    <div id="gameOver">Game Over! Appuyez sur Espace pour recommencer</div>
  </div>

  <script>
    let board = [[0,0,0,0], [0,0,0,0], [0,0,0,0], [0,0,0,0]];
    let score = 0;
    let gameRunning = true;

    function initGame() {
      board = [[0,0,0,0], [0,0,0,0], [0,0,0,0], [0,0,0,0]];
      score = 0;
      gameRunning = true;
      document.getElementById('gameOver').style.display = 'none';
      addNewTile();
      addNewTile();
      updateBoard();
    }

    function addNewTile() {
      let emptyCells = [];
      for (let i = 0; i < 4; i++) {
        for (let j = 0; j < 4; j++) {
          if (board[i][j] === 0) emptyCells.push({i, j});
        }
      }
      if (emptyCells.length > 0) {
        let {i, j} = emptyCells[Math.floor(Math.random() * emptyCells.length)];
        board[i][j] = Math.random() < 0.9 ? 2 : 4;
      }
    }

    function updateBoard() {
      const grid = document.getElementById('grid');
      grid.innerHTML = '';
      for (let i = 0; i < 4; i++) {
        const row = document.createElement('div');
        row.className = 'row';
        for (let j = 0; j < 4; j++) {
          const cell = document.createElement('div');
          cell.className = 'cell';
          if (board[i][j] !== 0) {
            cell.textContent = board[i][j];
            cell.setAttribute('data-value', board[i][j]);
          }
          row.appendChild(cell);
        }
        grid.appendChild(row);
      }
      document.getElementById('score').textContent = 'Score: ' + score;
    }

    function move(direction) {
      if (!gameRunning) return;
      let moved = false;
      const oldBoard = JSON.stringify(board);

      if (direction === 'left' || direction === 'right') {
        for (let i = 0; i < 4; i++) {
          let row = direction === 'left' ? board[i] : board[i].reverse();
          let newRow = slide(row);
          if (direction === 'right') newRow.reverse();
          board[i] = newRow;
        }
      } else {
        for (let j = 0; j < 4; j++) {
          let col = [board[0][j], board[1][j], board[2][j], board[3][j]];
          col = direction === 'up' ? col : col.reverse();
          let newCol = slide(col);
          if (direction === 'down') newCol.reverse();
          for (let i = 0; i < 4; i++) board[i][j] = newCol[i];
        }
      }

      if (JSON.stringify(board) !== oldBoard) {
        addNewTile();
        updateBoard();
        if (!canMove()) {
          gameRunning = false;
          document.getElementById('gameOver').style.display = 'block';
        }
      }
    }

    function slide(row) {
      let arr = row.filter(val => val !== 0);
      for (let i = 0; i < arr.length - 1; i++) {
        if (arr[i] === arr[i + 1]) {
          arr[i] *= 2;
          score += arr[i];
          arr.splice(i + 1, 1);
        }
      }
      while (arr.length < 4) arr.push(0);
      return arr;
    }

    function canMove() {
      for (let i = 0; i < 4; i++) {
        for (let j = 0; j < 4; j++) {
          if (board[i][j] === 0) return true;
          if (j < 3 && board[i][j] === board[i][j + 1]) return true;
          if (i < 3 && board[i][j] === board[i + 1][j]) return true;
        }
      }
      return false;
    }

    document.addEventListener('keydown', (e) => {
      if (e.key === ' ' && !gameRunning) {
        initGame();
        return;
      }
      switch(e.key) {
        case 'ArrowUp': move('up'); break;
        case 'ArrowDown': move('down'); break;
        case 'ArrowLeft': move('left'); break;
        case 'ArrowRight': move('right'); break;
      }
    });

    initGame();
  </script>
</body>
</html>